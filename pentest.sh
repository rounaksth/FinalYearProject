#!/bin/bash

# Accepting user inputs
TARGET_URL="$1"
SCAN_TYPE="$2"
SCAN_DEPTH="$3"
TIMEOUT="$4"

# Function to perform SQL Injection Scan
perform_sqli_scan() {
    echo "SQL Injection Scan in progress..."
    sqlmap -u "$TARGET_URL" --batch --level="$SCAN_DEPTH" --timeout="$TIMEOUT" --risk=3 | tee output.txt
    echo "SQL Injection Scan|High|Use prepared statements"
}


# Function to perform Nmap Scan
perform_nmap_scan() {
    echo "Running Nmap Scan..."
    nmap -sV -A -T4 "$TARGET_URL" -oN nmap_results.txt
    echo "Nmap Scan Completed."
    
    # Display results for GUI
    echo "====== Nmap Scan Report ======"
    cat nmap_results.txt
    echo "=============================="
}

# Function to perform XSS Scan
perform_xss_scan() {
    echo "XSS Scan in progress..."
    xsstrike -u "$TARGET_URL" --crawl --timeout "$TIMEOUT" | tee output.txt
    echo "Cross-Site Scripting|Medium|Implement CSP & input validation"
}

# Function to perform a comprehensive scan
perform_comprehensive_scan() {
    echo "Running Comprehensive Scan..."
    perform_sqli_scan
    perform_xss_scan
}

# Select the appropriate scan type
case "$SCAN_TYPE" in
    "SQLi") perform_sqli_scan ;;
    "XSS") perform_xss_scan ;;
    "Nmap") perform_nmap_scan ;;
    "Comprehensive") 
        perform_sqli_scan
        perform_xss_scan
        perform_nmap_scan
        ;;
    *) echo "Invalid Scan Type. Use SQLi, XSS, Nmap, or Comprehensive." ;;
esac

